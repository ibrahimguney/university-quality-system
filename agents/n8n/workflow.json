{
  "name": "Create Quality Issues 3 Weeks Before Term",
  "nodes": [
    {
      "parameters": {
        "triggerTimes": {
          "item": [
            {
              "hour": 9,
              "minute": 0
            }
          ]
        }
      },
      "id": "Cron1",
      "name": "Cron (Daily 09:00 TR)",
      "type": "n8n-nodes-base.cron",
      "typeVersion": 2,
      "position": [240, 260]
    },
    {
      "parameters": {
        "values": {
          "string": [
            { "name": "OWNER", "value": "your-github-username-or-org" },
            { "name": "REPO", "value": "university-quality-system" },
            { "name": "TERM_START", "value": "2025-09-22T09:00:00+03:00" }
          ]
        }
      },
      "id": "SetConfig",
      "name": "Config",
      "type": "n8n-nodes-base.set",
      "typeVersion": 2,
      "position": [480, 260]
    },
    {
      "parameters": {
        "functionCode": "const termStart = new Date($json[\"TERM_START\"]);\nconst now = new Date();\n// TR saat dilimi farklarını tolere etmek için sadece gün bazında farkı hesapla\nconst msPerDay = 24*60*60*1000;\nconst diffDays = Math.floor((termStart - now) / msPerDay);\nreturn [{ json: { shouldCreate: diffDays === 21, diffDays } }];"
      },
      "id": "FnCheck21Days",
      "name": "Check (21 days before?)",
      "type": "n8n-nodes-base.function",
      "typeVersion": 2,
      "position": [720, 260]
    },
    {
      "parameters": {
        "conditions": {
          "boolean": [{ "value1": "={{$json[\"shouldCreate\"]}}", "operation": "isTrue" }]
        }
      },
      "id": "IfGate",
      "name": "IF shouldCreate",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2,
      "position": [960, 260]
    },
    {
      "parameters": {
        "functionCode": "const issues = [\n  {\n    title: \"[To Do] Ders planları ve syllabus güncellemesi\",\n    body: `## 🎯 Görev\\nTüm ders planlarının ve syllabus belgelerinin yeni döneme uygun şekilde güncellenmesi.\\nBologna çıktıları ile ölçme yöntemleri uyumu kontrol edilecek.\\n\\n## ✅ Yapılacaklar\\n- [ ] Program ders listelerinin kontrol edilmesi\\n- [ ] Syllabus dosyalarının güncellenmesi\\n- [ ] OBİS/LMS sistemine yüklenmesi\\n\\n## 👥 Sorumlu\\n- Fakülte/Program Başkanlığı\\n- Dersin ilgili öğretim elemanı\\n\\n## ⏰ Hedef Tarih\\nDönem başlamadan 3 hafta – **Kesinleştirme 1 hafta kala**`,\n    labels: [\"To Do\", \"Kalite\"]\n  },\n  {\n    title: \"[To Do] Akademik danışmanlık planlarının güncellenmesi\",\n    body: `## 🎯 Görev\\nDanışman-öğrenci eşleştirmelerinin yapılması ve danışmanlık süreçlerinin netleştirilmesi.\\n\\n## ✅ Yapılacaklar\\n- [ ] Danışman atama listelerinin güncellenmesi\\n- [ ] Danışmanlık formlarının hazırlanması\\n- [ ] Öğrencilere duyuru yapılması\\n\\n## 👥 Sorumlu\\n- Fakülte sekreterliği\\n- Bölüm başkanları\\n\\n## ⏰ Hedef Tarih\\nDönem başlamadan 3 hafta önce`,\n    labels: [\"To Do\", \"Danışmanlık\"]\n  },\n  {\n    title: \"[To Do] Öğrenci oryantasyon programı planlama\",\n    body: `## 🎯 Görev\\nYeni kayıtlı öğrenciler için tanıtım ve kalite farkındalığı oryantasyonu hazırlamak.\\n\\n## ✅ Yapılacaklar\\n- [ ] Program takviminin hazırlanması\\n- [ ] Akademik birimlerin sunum içeriklerinin hazırlanması\\n- [ ] Kalite güvence sistemi hakkında bilgilendirme eklenmesi\\n\\n## 👥 Sorumlu\\n- Öğrenci işleri dairesi\\n- Fakülte kalite temsilcileri\\n\\n## ⏰ Hedef Tarih\\nDönem başlamadan 2 hafta önce`,\n    labels: [\"To Do\", \"Oryantasyon\"]\n  },\n  {\n    title: \"[To Do] Geçen dönem anket sonuçlarının analizi\",\n    body: `## 🎯 Görev\\n2024–25 bahar yarıyılı anket ve öğrenci başarısı verilerini analiz ederek iyileştirme planı oluşturmak.\\n\\n## ✅ Yapılacaklar\\n- [ ] Öğrenci ders değerlendirme sonuçlarını analiz et\\n- [ ] Akademik performans göstergelerini çıkar\\n- [ ] İyileştirme önerileri raporunu hazırla\\n\\n## 👥 Sorumlu\\n- Kalite komisyonu\\n- Akademik değerlendirme birimi\\n\\n## ⏰ Hedef Tarih\\nGüz yarıyılı başlamadan 3 hafta önce`,\n    labels: [\"To Do\", \"Anket Analizi\"]\n  },\n  {\n    title: \"[To Do] PUKÖ döngüsü iyileştirme eylem planı hazırlama\",\n    body: `## 🎯 Görev\\nÖnceki yıl alınan kararların etkilerini değerlendirmek ve yeni dönem için düzeltici faaliyet planı oluşturmak.\\n\\n## ✅ Yapılacaklar\\n- [ ] Önceki yıl “Kontrol” aşaması çıktılarının incelenmesi\\n- [ ] Eksik veya zayıf noktaların belirlenmesi\\n- [ ] Yeni dönem için düzeltici faaliyetlerin planlanması\\n\\n## 👥 Sorumlu\\n- Fakülte kalite kurulu\\n- Bölüm kalite temsilcileri\\n\\n## ⏰ Hedef Tarih\\nDönem başlamadan 2 hafta önce`,\n    labels: [\"To Do\", \"PUKÖ\"]\n  }\n];\nreturn issues.map(i => ({ json: i }));"
      },
      "id": "FnPrepareIssues",
      "name": "Prepare Issues",
      "type": "n8n-nodes-base.function",
      "typeVersion": 2,
      "position": [1160, 140]
    },
    {
      "parameters": {
        "owner": "={{$json[\"OWNER\"]}}",
        "repository": "={{$json[\"REPO\"]}}",
        "title": "={{$json[\"title\"]}}",
        "body": "={{$json[\"body\"]}}",
        "additionalFields": {
          "labels": "={{$json[\"labels\"]}}"
        },
        "resource": "issue",
        "operation": "create"
      },
      "id": "GitHubCreateIssue",
      "name": "GitHub → Create Issue",
      "type": "n8n-nodes-base.github",
      "typeVersion": 2,
      "position": [1480, 140],
      "credentials": {
        "githubApi": {
          "id": "REPLACE_WITH_YOUR_GITHUB_CREDENTIAL_ID",
          "name": "GitHub (PAT)"
        }
      }
    },
    {
      "parameters": {},
      "id": "Noop",
      "name": "No-Op (Not 21 days)",
      "type": "n8n-nodes-base.noOp",
      "typeVersion": 1,
      "position": [1160, 360]
    }
  ],
  "connections": {
    "Cron (Daily 09:00 TR)": {
      "main": [[{ "node": "Config", "type": "main", "index": 0 }]]
    },
    "Config": {
      "main": [[{ "node": "Check (21 days before?)", "type": "main", "index": 0 }]]
    },
    "Check (21 days before?)": {
      "main": [
        [
          { "node": "IF shouldCreate", "type": "main", "index": 0 }
        ]
      ]
    },
    "IF shouldCreate": {
      "main": [
        [
          { "node": "Prepare Issues", "type": "main", "index": 0 }
        ],
        [
          { "node": "No-Op (Not 21 days)", "type": "main", "index": 0 }
        ]
      ]
    },
    "Prepare Issues": {
      "main": [[{ "node": "GitHub → Create Issue", "type": "main", "index": 0 }]]
    }
  }
}
